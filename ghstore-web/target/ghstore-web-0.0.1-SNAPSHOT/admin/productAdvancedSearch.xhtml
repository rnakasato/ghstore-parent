<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html 	xmlns="http://www.w3.org/1999/xhtml"
		xmlns:h="http://xmlns.jcp.org/jsf/html"
		xmlns:f="http://java.sun.com/jsf/core"
		xmlns:ui="http://java.sun.com/jsf/facelets"
		xmlns:p="http://primefaces.org/ui"
		xmlns:pe="http://primefaces.org/ui/extensions">
	<ui:composition template="/layout/adminLayout.xhtml">
		<h:head>
			<title>GHStore - Salvar Produto</title>
			<h:outputStylesheet name="baseStyles.css" library="css" />						
		</h:head>
		<ui:define name="sidebar">
			<ui:include src="/admin/productMenu.xhtml"/>
		</ui:define>
		<ui:define name="content">
			<h:form id="form_content">
					<p:watermark for="name" value="Buscar Produto..." />
					<p:panelGrid columns="2" style="width:100%">
						<p:commandButton icon="ui-icon-search" value="Buscar" actionListener="#{adminProductMB.listProducts}" update="productTable"/>
						<p:inputText id="name" value="#{adminProductMB.filter.name}" />
						<p:outputLabel for="category" value="Categoria:" />
						<p:selectOneMenu id="category" 
										value="#{adminProductMB.filter.category.description}">
							<f:selectItem itemValue="null" itemLabel="Todos"/>
							<f:selectItems value="#{adminProductMB.categoryList}"
										var="cat"
										itemValue="#{cat.description}"
										itemLabel="#{cat.description}"/>
						</p:selectOneMenu>
						<p:outputLabel value="Subcategoria:" for="subcategory" />
	        			<p:autoComplete id="subcategory" 
	        							dropdown="true" 
	        							value="#{adminProductMB.filter.subcategory.description}" 
	        							completeMethod="#{adminProductMB.fillSubcategory}"/>
						<p:outputLabel for="status" value="Status:" />
						<p:selectOneRadio id="status" value="#{adminProductMB.filter.status}">
							<f:selectItem itemLabel="Disponível" itemValue="1"/>
							<f:selectItem itemLabel="Indisponível" itemValue="2"/>
							<f:selectItem itemLabel="Todos" itemValue="0"/>
						</p:selectOneRadio>
						<p:outputLabel for="orderby" value="Ordenar por:" />
						<p:selectOneMenu id="orderby" 
										value="#{adminProductMB.order}">
							<f:selectItems value="#{adminProductMB.orderTypeList}"
										var="orderP"
										itemValue="#{orderP.id}"
										itemLabel="#{orderP.description}"/>
						</p:selectOneMenu>
						<p:commandButton value="Limpar filtros" actionListener="#{adminProductMB.clearFilter}" update="form_content"/>
					</p:panelGrid>		
					<p:dataTable var="prod" 
								id="productTable" 
								value="#{adminProductMB.productList}"
								paginator="true"
								selection="#{adminProductMB.product}"
								rowKey="#{prod.id}"
								rows="15"	
								style="width:100%">
								
						<p:column selectionMode="single" style="width:16px;text-align:center"/>		
						<p:column headerText="Nome">
    						<!-- row record -->
    						<h:outputText value="#{prod.name}"/>
		    			</p:column>
		    			<p:column headerText="Categoria">
    						<!-- row record -->
    						<h:outputText value="#{prod.storeCategory.description}"/>
		    			</p:column>
		    			<p:column headerText="Subcategoria">
    						<!-- row record -->
    						<h:outputText value="#{prod.subcategory.description}"/>
		    			</p:column>
		    			<p:column headerText="Estoque">
    						<!-- row record -->
    						<h:outputText value="#{prod.stock}"/>
		    			</p:column>
		    			<p:column headerText="Preço unitário">
    						<!-- row record -->
    						<h:outputText value="#{prod.price}"/>
		    			</p:column>
		    			<p:column headerText="Status">
    						<!-- row record -->
    						<h:outputText value="#{prod.statusDesc}"/>
		    			</p:column>
					</p:dataTable>
					<p:panelGrid columns="3">
		                   	<p:commandButton value="Detalhes do produto" 
		                   		  
		                   		id="detail"  
		                   		icon="ui-icon-search"
		                   		update=":form_content:prodDetail, :messages "
		                   		actionListener="#{adminProductMB.showProductDetails}"		                   		 
		                   		/>		                   		
			               
		                   	<p:commandButton value="Voltar" id="cancel" actionListener="#{redirectMB.redirectToProductMenu}" icon="ui-icon-arrowreturnthick-1-w"/>
		                   	<p:commandButton value="Limpar resultados" update="form_content" id="clear" actionListener="#{adminProductMB.clearTableResults}" >
		                   		<p:confirm header="Produto" message="Tem certeza que deseja limpar os resultados da pesquisa?"/>
			                </p:commandButton>
	                  </p:panelGrid>
	                 <p:dialog id="productDetail" header="Produto" widgetVar="prodDialog" modal="true" showEffect="fade" hideEffect="fade" resizable="false" width="512px">
						<p:outputPanel id="prodDetail" style="text-align:center;">
				            <p:panelGrid  columns="2" rendered="true" columnClasses="label,value">
				                <f:facet name="header">
				                    <p:graphicImage value="#{adminProductMB.getImagePath(adminProductMB.product)}" style="width:256px;heigth:256px"/> 
				                </f:facet>
				 
				                <h:outputText value="Nome" />
				                <h:outputText value="#{adminProductMB.product.name}" />
				 
				                <h:outputText value="Descrição" />
				                <h:outputText value="#{adminProductMB.product.description}" />
				 
				                <h:outputText value="Categoria" />
				                <h:outputText value="#{adminProductMB.product.storeCategory.description}"/>
				                
				 				<h:outputText value="Subcategoria" />
				                <h:outputText value="#{adminProductMB.product.subcategory.description}"/>
				                
				                <h:outputText value="Tags" />
				                <h:outputText value="#{formatterUtilMB.formatTagList(adminProductMB.product.tagList)}"/>
				 				
				                <h:outputText value="Preço" />
				                <h:outputText value="R$#{adminProductMB.product.price}" />
				                
				                <h:outputText value="Data de início de venda" />
				                <h:outputText value="#{adminProductMB.product.insertdate}" />
				            </p:panelGrid>
				        </p:outputPanel>
				    </p:dialog>                    
                    <p:confirmDialog severity="alert"
							 global="true" 
							 widgetVar="dialog">  
				        <p:commandButton id="save"	value="Sim" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />			                                
				        <p:commandButton id="ignore"  value="Não"  type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close"/>
					</p:confirmDialog>
			</h:form>	
			
		</ui:define>
	</ui:composition>
</html>